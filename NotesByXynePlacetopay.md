# Hyperswitch to UCS Connector Conversion Notes - Placetopay

## Conversion Progress Tracking

### Phase 1: Analysis ✅
- [x] Read UCS Implementation Guide
- [x] Fetch Hyperswitch Placetopay implementation
- [x] Extract authentication patterns
- [x] Extract API endpoints and methods
- [x] Extract request/response structures
- [x] Extract payment method support

### Phase 2: UCS Setup ⏳
- [ ] Update domain_types/connector_types.rs
- [ ] Register connector in connector-integration/types.rs
- [ ] Update configuration files

### Phase 3: Conversion ⏳
- [ ] Convert main connector file
- [ ] Convert transformers
- [ ] Implement all flows from Hyperswitch

### Phase 4: Testing ⏳
- [ ] Build validation
- [ ] Error fixes
- [ ] Flow testing

## Key Findings from Hyperswitch Analysis

### Authentication Pattern
```rust
// Uses BodyKey auth with login and tran_key
ConnectorAuthType::BodyKey { api_key, key1 } => {
    login: api_key,
    tran_key: key1,
}
// Generates nonce, seed, and SHA256 hash for auth
```

### API Endpoints
```rust
// Authorize: {base_url}/process
// Sync: {base_url}/query  
// Capture: {base_url}/transaction
// Void: {base_url}/transaction
// Refund: {base_url}/transaction
// Refund Sync: {base_url}/query
```

### Supported Flows
- [x] Authorize - PlacetopayPaymentsRequest/PlacetopayPaymentsResponse
- [x] Capture - PlacetopayNextActionRequest/PlacetopayPaymentsResponse
- [x] Void - PlacetopayNextActionRequest/PlacetopayPaymentsResponse
- [x] Refund - PlacetopayRefundRequest/PlacetopayRefundResponse
- [x] Sync - PlacetopayPsyncRequest/PlacetopayPaymentsResponse
- [x] Refund Sync - PlacetopayRsyncRequest/PlacetopayRefundResponse

### Request/Response Structures
```rust
// Main request types:
- PlacetopayPaymentsRequest (Authorize)
- PlacetopayPsyncRequest (Sync)
- PlacetopayNextActionRequest (Capture/Void)
- PlacetopayRefundRequest (Refund)
- PlacetopayRsyncRequest (Refund Sync)

// Main response types:
- PlacetopayPaymentsResponse (Authorize/Sync/Capture/Void)
- PlacetopayRefundResponse (Refund/Refund Sync)
- PlacetopayErrorResponse (Errors)
```

### Payment Methods Supported
- [x] Cards (Credit/Debit) - Visa, Mastercard, AmEx, DinersClub
- [ ] Other methods - Not implemented in Hyperswitch

### Key Implementation Details
- Uses MinorUnit for amounts
- Requires browser info (IP address, user agent)
- Auth uses SHA256 hash with nonce and seed
- Only supports full refunds (not partial)
- Uses internal_reference for transaction IDs
- Status mapping from Placetopay statuses to Hyperswitch enums

## Conversion Notes

### Key Pattern Conversions
- Hyperswitch RouterData → UCS RouterDataV2
- Hyperswitch macros → UCS macros
- Auth type conversions
- Error response patterns

### Issues Encountered
- (To be documented during conversion)

### Solutions Applied
- (To be documented during conversion)

## Testing Results
- (To be filled during testing phase)

---
*Generated by Xyne AI Assistant for Placetopay connector conversion*