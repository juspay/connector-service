syntax = "proto3";

package ucs.v2;

import "payment.proto";
import "payment_methods.proto";

option go_package = "github.com/juspay/connector-service/backend/grpc-api-types/proto;proto";

// Request message for composite authorize flow.
message CompositeAuthorizeRequest {
  // Payment Identification
  Identifier request_ref_id = 1; // Reference ID for tracking

  // Account-Specific Configuration
  optional SecretString merchant_account_metadata = 2; // Account-level configuration metadata (e.g., merchant_name, brand_id)

  // Metadata
  optional SecretString metadata = 3; // Additional metadata for the connector
  optional SecretString connector_metadata = 4; // Connector-specific metadata for the transaction

  // Environment Configuration
  optional bool test_mode = 5; // A boolean value to indicate if the connector is in Test mode

  // Customer Information
  optional string customer_name = 6; // Name of the customer
  optional SecretString email = 7; // Email address of the customer
  optional string customer_id = 8; // Merchant's customer ID
  optional string phone_number = 9; // Phone number of the customer

  // Address Information
  optional PaymentAddress address = 10; // Billing and shipping address details

  // Amount Information
  int64 amount = 11; // The amount for the payment in major currency units
  Currency currency = 12; // The currency for the payment, in ISO 4217 three-letter code
  int64 minor_amount = 13; // The minor amount for the payment (e.g., cents)
  optional int64 order_tax_amount = 14; // Tax amount for the order
  optional int64 shipping_cost = 15; // Cost of shipping for the order

  // Payment Method and Capture Settings
  PaymentMethod payment_method = 16; // Payment method to be used
  optional CaptureMethod capture_method = 17; // Method for capturing the payment
  optional string connector_customer_id = 18; // Customer ID as recognized by the connector

  // Authentication Details
  AuthenticationType auth_type = 19; // Type of authentication to be used
  optional bool enrolled_for_3ds = 20; // Indicates if the customer is enrolled for 3D Secure
  optional AuthenticationData authentication_data = 21; // Additional authentication data

  // URLs for Redirection and Webhooks
  optional string return_url = 22; // URL to redirect after payment
  optional string webhook_url = 23; // URL for webhook notifications
  optional string complete_authorize_url = 24; // URL to complete authorization

  // Session and Token Information
  optional string session_token = 25; // Session token, if applicable

  // Order Details
  optional string order_category = 26; // Category of the order
  optional string merchant_order_reference_id = 27; // Merchant's internal reference ID
  optional string connector_order_reference_id = 28; // Connector's reference id for order

  // Behavioral Flags and Preferences
  optional FutureUsage setup_future_usage = 29; // Indicates future usage intention
  optional bool off_session = 30; // Indicates if off-session transaction
  optional bool request_incremental_authorization = 31; // Indicates if incremental authorization is requested
  optional bool request_extended_authorization = 32; // Indicates if extended authorization is requested
  optional bool enable_partial_authorization = 33; // Indicates if partial authorization is enabled

  // Contextual Information
  optional CustomerAcceptance customer_acceptance = 34; // Details of customer acceptance
  optional BrowserInformation browser_info = 35; // Information about the customer's browser
  optional PaymentExperience payment_experience = 36; // Preferred payment experience
  optional string description = 37; // Additional description for the payment
  optional PaymentChannel payment_channel = 38; // Describes the channel through which the payment was initiated

  // Mandate Setup Details
  optional SetupMandateDetails setup_mandate_details = 39; // Setup mandate details for the authorization

  // Statement Descriptor
  optional string statement_descriptor_name = 40; // Complete description that appears on customers' statements
  optional string statement_descriptor_suffix = 41; // Provides information about a card payment that customers see on their statements
  optional BillingDescriptor billing_descriptor = 42; // Billing Descriptor information to be sent to the payment gateway

  // State Information
  optional ConnectorState state = 43; // State data for access token storage and other connector-specific state

  // Order Line Items
  repeated OrderDetailsWithAmount order_details = 44; // Details about the different products for which the payment is being made

  // Locale Information
  optional string locale = 45; // Locale/language preference for the shopper (e.g., "en-US")

  // Tokenization Configuration
  optional Tokenization tokenization_strategy = 46; // Tokenization strategy for payment processing

  // Payment Method Token
  optional string payment_method_token = 47;

  // URL for Redirection
  optional string continue_redirection_url = 48; // URL to complete authorization

  // Indicates if 3DS method data was successfully completed or not
  optional ThreeDsCompletionIndicator threeds_completion_indicator = 49;

  // Redirection Information after DDC step
  optional RedirectionResponse redirection_response = 50; // Redirection Response from client browser
}

// Response message for composite authorize flow.
message CompositeAuthorizeResponse {
  optional PaymentServiceCreateAccessTokenResponse access_token_response = 1; // Access token flow response
  optional PaymentServiceCreateConnectorCustomerResponse create_customer_response = 2; // Create customer flow response
  optional PaymentServiceAuthorizeResponse authorize_response = 3; // Authorize flow response
}
